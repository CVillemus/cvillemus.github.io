"use strict";(self.webpackChunkflechettes=self.webpackChunkflechettes||[]).push([[845],{2845:(M,d,c)=>{c.r(d),c.d(d,{ScoreBattleComponent:()=>w});var s=c(6814),i=c(95),e=c(4946),u=c(9275);function p(o,r){if(1&o&&(e.O4$(),e.kcU(),e.ynx(0),e._uU(1),e.BQk()),2&o){const t=e.oxw();e.xp6(1),e.hij("",t.selectedGameMode," -")}}function _(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){const l=e.CHM(t).$implicit,C=e.oxw(2);return e.KtG(C.initGame(l))}),e._uU(1),e.qZA()}if(2&o){const t=r.$implicit;e.xp6(1),e.Oqu(t)}}function h(o,r){if(1&o&&(e.O4$(),e.kcU(),e.TgZ(0,"div",16)(1,"p")(2,"strong"),e._uU(3,"R\xe8gles :"),e.qZA(),e._uU(4," Vous commencez la partie avec le score s\xe9lectionn\xe9, le premier joueur \xe0 atteindre 0 gagne la partie. Chaque tour, jouez vos 3 fl\xe9chettes et utilisez l'application pour soustraire le total des points marqu\xe9s au reste des points \xe0 faire. Pour finir la partie, il faut tomber sur le montant exact des points qu'il vous manque. Pas besoin de finir sur la 3e fl\xe9chette de votre tour. "),e.qZA(),e.TgZ(5,"a",17),e._uU(6,"Cliquez ici si vous ne savez pas \xe0 quoi correspondent les points"),e.qZA(),e.TgZ(7,"div",18),e.YNc(8,_,2,1,"button",19),e.qZA()()),2&o){const t=e.oxw();e.xp6(8),e.Q6J("ngForOf",t.gameModes)}}function g(o,r){if(1&o&&(e.TgZ(0,"div",28),e._uU(1),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.hij(" ",t.selectedGameMode," ")}}function m(o,r){if(1&o&&(e.TgZ(0,"span",31),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.roundScore)}}function f(o,r){if(1&o&&(e.TgZ(0,"div",28)(1,"span",29),e._uU(2),e.qZA(),e.YNc(3,m,2,1,"span",30),e.qZA()),2&o){const t=r.$implicit;e.xp6(2),e.Oqu(t.newScore),e.xp6(1),e.Q6J("ngIf",t.roundScore)}}function S(o,r){if(1&o&&(e.TgZ(0,"div",23)(1,"div",24),e._uU(2),e.qZA(),e.TgZ(3,"div",25),e.YNc(4,g,2,1,"div",26),e.YNc(5,f,4,2,"div",27),e.qZA()()),2&o){const t=r.$implicit,n=e.oxw(2);e.xp6(2),e.Oqu(t.player.name),e.xp6(2),e.Q6J("ngIf",n.selectedGameMode),e.xp6(1),e.Q6J("ngForOf",t.round)}}function v(o,r){if(1&o&&(e.O4$(),e.kcU(),e.TgZ(0,"div",21),e.YNc(1,S,6,3,"div",22),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.scoreBattleData.playerScores.reverse())}}function y(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",32)(2,"b"),e._uU(3),e.qZA(),e.TgZ(4,"p"),e._uU(5),e.qZA()(),e.TgZ(6,"div",33)(7,"input",34),e.NdJ("keyup.enter",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.updateScore())}),e.qZA(),e.TgZ(8,"span",35)(9,"ul")(10,"li")(11,"button",36),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.updateScore())}),e.O4$(),e.TgZ(12,"svg",37),e._UZ(13,"path",4)(14,"circle",38)(15,"path",39)(16,"path",40)(17,"path",41)(18,"path",42)(19,"path",43),e.qZA()()()()()()()}if(2&o){const t=r.ngIf,n=e.oxw();e.xp6(3),e.hij("Tour de ",t.player.name,"."),e.xp6(2),e.hij("score moyen : ",t.averageScore,""),e.xp6(2),e.Q6J("formControl",n.scoreControl)}}function x(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",44),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.resetGame())}),e._uU(1,"Reset game"),e.qZA()}}let w=(()=>{class o{constructor(t){this.playerService=t,this.scoreControl=new i.NI("",[i.kI.required]),this.indexOfPlayingPlayer=0,this.gameModes=[301,501],this.isGameEnded=!1}ngOnInit(){this.fetchData()}initGame(t){this.isGameEnded=!1,this.selectedGameMode=t;let n=[];this.players?.forEach(a=>{n.push({player:a,round:[],averageScore:0})}),this.scoreBattleData={score:t,playerScores:n,ladder:[]}}fetchData(){this.players=this.playerService.getPlayers().value,this.indexOfPlayingPlayer=this.players.length-1}getPlayingPlayerData(){return this.playingPlayerScore=this.scoreBattleData?.playerScores[this.indexOfPlayingPlayer]}pushRound(t){console.log("3 : postRound"),this.scoreBattleData?.playerScores[this.indexOfPlayingPlayer].round.push(t),this.updateAverage(),this.goToNextPlayer()}goToNextPlayer(){console.log("5 : goToNextPlayer"),this.players&&0==this.indexOfPlayingPlayer?this.indexOfPlayingPlayer=this.players.length-1:this.indexOfPlayingPlayer--;let t=this.getPlayingPlayerData();t&&t.round[t.round.length-1]&&0==t.round[t.round.length-1].newScore&&(this.playerService.addWin(t.player.id),this.scoreBattleData&&this.scoreBattleData.ladder.push(t.player)),this.scoreBattleData?.ladder.includes(this.scoreBattleData?.playerScores[this.indexOfPlayingPlayer].player)&&(this.scoreBattleData?.ladder.length==this.scoreBattleData?.playerScores.length?(this.isGameEnded=!0,console.log("END GAME"),window.scrollTo(0,window.innerHeight)):this.goToNextPlayer())}updateAverage(){console.log("4 : updateAverage"),this.scoreBattleData&&(this.scoreBattleData.playerScores[this.indexOfPlayingPlayer].averageScore=this.getNewAverage())}getNewAverage(){let t=0,n=0;return this.scoreBattleData?.playerScores[this.indexOfPlayingPlayer].round.forEach(a=>{t+=a.roundScore}),this.scoreBattleData&&(n=Math.round(t/this.scoreBattleData.playerScores[this.indexOfPlayingPlayer].round.length)),n}useMocks(){this.selectedGameMode=301,this.players=[{id:"1",name:"Quentin",wonRounds:0},{id:"2",name:"Thomas",wonRounds:0},{id:"3",name:"Ali\xe9nor",wonRounds:0},{id:"4",name:"Valentin",wonRounds:0}],this.scoreBattleData={score:301,playerScores:[{player:{id:"1",name:"Quentin",wonRounds:0},round:[{previousScore:301,roundScore:70,newScore:231},{previousScore:231,roundScore:31,newScore:200},{previousScore:200,roundScore:101,newScore:99}],averageScore:67.3},{player:{id:"2",name:"Thomas",wonRounds:0},round:[{previousScore:301,roundScore:70,newScore:231},{previousScore:231,roundScore:31,newScore:200},{previousScore:200,roundScore:101,newScore:99}],averageScore:67.3},{player:{id:"3",name:"Ali\xe9nor",wonRounds:0},round:[{previousScore:301,roundScore:70,newScore:231},{previousScore:231,roundScore:31,newScore:200},{previousScore:200,roundScore:101,newScore:99}],averageScore:67.3},{player:{id:"4",name:"Valentin",wonRounds:0},round:[{previousScore:301,roundScore:70,newScore:231},{previousScore:231,roundScore:31,newScore:200},{previousScore:200,roundScore:101,newScore:99}],averageScore:67.3}],ladder:[]}}updateScore(){console.log("1 : updateScore");let t=this.getPlayingPlayerData(),n=Number(this.scoreControl.value);this.scoreControl.setValue(""),t?.round&&(console.log("2 : postRound"),t.round[t.round.length-1]?this.postRound(t,n):this.postFirstRound(n))}postFirstRound(t){this.selectedGameMode&&this.pushRound({previousScore:this.selectedGameMode,roundScore:t,newScore:this.selectedGameMode-t})}postRound(t,n){this.pushRound(t.round[t.round.length-1].newScore<n?{previousScore:t.round[t.round.length-1].newScore,newScore:t.round[t.round.length-1].newScore,roundScore:n}:{previousScore:t.round[t.round.length-1].newScore,newScore:t.round[t.round.length-1].newScore-n,roundScore:n})}resetGame(){this.selectedGameMode&&(this.fetchData(),this.initGame(this.selectedGameMode))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(u.l))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-score"]],standalone:!0,features:[e.jDz],decls:17,vars:5,consts:[[1,"section-main"],[1,"container"],[1,"title-section"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","stroke-width","2","stroke","currentColor","fill","none","stroke-linecap","round","stroke-linejoin","round",1,"icon","icon-tabler","icon-tabler-device-gamepad-2"],["stroke","none","d","M0 0h24v24H0z","fill","none"],["d","M12 5h3.5a5 5 0 0 1 0 10h-5.5l-4.015 4.227a2.3 2.3 0 0 1 -3.923 -2.035l1.634 -8.173a5 5 0 0 1 4.904 -4.019h3.4z"],["d","M14 15l4.07 4.284a2.3 2.3 0 0 0 3.925 -2.023l-1.6 -8.232"],["d","M8 9v2"],["d","M7 10h2"],["d","M14 10h2"],[4,"ngIf"],["class","rules",4,"ngIf"],["class","player-table-container",4,"ngIf"],[1,"round-setter"],["class","container",4,"ngIf"],["class","button reset-button",3,"click",4,"ngIf"],[1,"rules"],["href","https://conseilsport.decathlon.fr/comment-compter-les-points-sur-une-cible-de-flechette"],[1,"list-cards","list-cards--oneline"],["class","card card--button",3,"click",4,"ngFor","ngForOf"],[1,"card","card--button",3,"click"],[1,"player-table-container"],["class","player-table",4,"ngFor","ngForOf"],[1,"player-table"],[1,"player-table__header","player-table__cell"],[1,"player-table__cell","player-table__cell--scores"],["class","score",4,"ngIf"],["class","score",4,"ngFor","ngForOf"],[1,"score"],[1,"score__current"],["class","score__marked",4,"ngIf"],[1,"score__marked"],[1,"round-setter__header"],[1,"card"],["type","text","placeholder","Entrez les points...",1,"card__main","card__input",3,"formControl","keyup.enter"],[1,"card__controls"],[1,"button-flat",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","stroke-width","2","stroke","currentColor","fill","none","stroke-linecap","round","stroke-linejoin","round",1,"icon","icon-tabler","icon-tabler-focus-2"],["cx","12","cy","12","r",".5","fill","currentColor"],["d","M12 12m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0"],["d","M12 3l0 2"],["d","M3 12l2 0"],["d","M12 19l0 2"],["d","M19 12l2 0"],[1,"button","reset-button",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"h2",2),e.O4$(),e.TgZ(3,"svg",3),e._UZ(4,"path",4)(5,"path",5)(6,"path",6)(7,"path",7)(8,"path",8)(9,"path",9),e.qZA(),e.YNc(10,p,2,1,"ng-container",10),e._uU(11," Course aux points "),e.qZA(),e.YNc(12,h,9,1,"div",11),e.YNc(13,v,2,1,"div",12),e.qZA(),e.kcU(),e.TgZ(14,"div",13),e.YNc(15,y,20,3,"div",14),e.YNc(16,x,2,0,"button",15),e.qZA()()),2&t&&(e.xp6(10),e.Q6J("ngIf",n.selectedGameMode),e.xp6(2),e.Q6J("ngIf",!n.scoreBattleData),e.xp6(1),e.Q6J("ngIf",n.scoreBattleData),e.xp6(2),e.Q6J("ngIf",n.scoreBattleData&&n.scoreBattleData.playerScores[n.indexOfPlayingPlayer]),e.xp6(1),e.Q6J("ngIf",n.isGameEnded))},dependencies:[s.ez,s.sg,s.O5,i.UX,i.Fj,i.JJ,i.oH],styles:[".player-table-container[_ngcontent-%COMP%]{margin-top:1.5rem;display:flex;flex-wrap:wrap;flex-direction:row}.player-table[_ngcontent-%COMP%]{width:calc(50% - 2px);border:1px solid #0d1517;font-size:1.125rem}.player-table[_ngcontent-%COMP%]:nth-child(odd){text-align:right}.player-table__cell[_ngcontent-%COMP%]{padding:.375rem 1rem;box-sizing:border-box}.player-table__cell--scores[_ngcontent-%COMP%]{max-height:123px;overflow-y:auto;direction:ltr}.player-table__header[_ngcontent-%COMP%]{border-bottom:1px solid #0d1517}.player-table[_ngcontent-%COMP%]:nth-child(odd)   .player-table__cell--scores[_ngcontent-%COMP%]{direction:rtl}.score[_ngcontent-%COMP%]{font-family:arial,sans-serif;display:flex;margin-bottom:.25rem}.score__current[_ngcontent-%COMP%], .score__marked[_ngcontent-%COMP%]{width:50px}.score__marked[_ngcontent-%COMP%]{font-style:italic;color:#a9a9a9}.round-setter[_ngcontent-%COMP%]{background-color:#f3f7f0;padding:.75rem 0;margin-top:1.5rem}.round-setter__header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:.75rem}.round-setter__header[_ngcontent-%COMP%]   b[_ngcontent-%COMP%]{font-size:1.125rem}.round-setter__header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem}.round-setter__footer[_ngcontent-%COMP%]{display:block;margin-top:.375rem;font-size:.75rem}.reset-button[_ngcontent-%COMP%]{margin-top:1.5rem;text-align:center;width:100%}"]}),o})()}}]);